{"version":3,"file":"index.js","sources":["../src/react-wechat-login.tsx"],"sourcesContent":["import * as React from \"react\";\r\n\r\nconst WechatLogin = ({\r\n  appid,\r\n  redirect_uri,\r\n  state,\r\n  style,\r\n  css,\r\n  onSuccess,\r\n}: {\r\n  appid: string;\r\n  redirect_uri: string;\r\n  state?: string;\r\n  style?: {};\r\n  css?: string;\r\n  height?: string;\r\n  width?: string;\r\n  onSuccess: (v: string) => void;\r\n}) => {\r\n  let sent = false;\r\n  const url = new URL(redirect_uri);\r\n  window.addEventListener(\"message\", (event) => {\r\n    if (\r\n      event.origin === url.origin && //确认消息来自于自己的域名 Make sure the message posted from your own origin\r\n      !event.data.source && //过滤掉一些调试组件发来的信息  Filter out some devtools message\r\n      !sent //避免多次运行回调函数  Avoid callback twice\r\n    ) {\r\n      sent = true;\r\n      onSuccess(event.data);\r\n    }\r\n  });\r\n  appid = `appid=${appid}`;\r\n  redirect_uri = `&redirect_uri=${encodeURIComponent(redirect_uri)}`;\r\n  const scope = `&scope=snsapi_login`;\r\n  state = state ? `&state=${state}` : ``;\r\n  style = style\r\n    ? { height: \"200px\", width: \"200px\", ...style }\r\n    : { height: \"200px\", width: \"200px\" };\r\n  css = css ? `&href=${css}` : ``;\r\n  const src =\r\n    `https://open.weixin.qq.com/connect/qrconnect?self_redirect=true&` +\r\n    appid +\r\n    redirect_uri +\r\n    scope +\r\n    state +\r\n    css;\r\n  return (\r\n    <iframe\r\n      id=\"frame_wechatlogin\"\r\n      title=\"WechatLogin\"\r\n      src={src}\r\n      frameBorder={\"0\"}\r\n      style={{ ...style }}\r\n    ></iframe>\r\n  );\r\n};\r\n\r\nexport default WechatLogin;\r\n"],"names":["React"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAEM,WAAW,GAAG,UAAC,EAgBpB;QAfC,KAAK,WAAA,EACL,YAAY,kBAAA,EACZ,KAAK,WAAA,EACL,KAAK,WAAA,EACL,GAAG,SAAA,EACH,SAAS,eAAA;IAWT,IAAI,IAAI,GAAG,KAAK,CAAC;IACjB,IAAM,GAAG,GAAG,IAAI,GAAG,CAAC,YAAY,CAAC,CAAC;IAClC,MAAM,CAAC,gBAAgB,CAAC,SAAS,EAAE,UAAC,KAAK;QACvC,IACE,KAAK,CAAC,MAAM,KAAK,GAAG,CAAC,MAAM;YAC3B,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM;YAClB,CAAC,IAAI;UACL;YACA,IAAI,GAAG,IAAI,CAAC;YACZ,SAAS,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;SACvB;KACF,CAAC,CAAC;IACH,KAAK,GAAG,WAAS,KAAO,CAAC;IACzB,YAAY,GAAG,mBAAiB,kBAAkB,CAAC,YAAY,CAAG,CAAC;IACnE,IAAM,KAAK,GAAG,qBAAqB,CAAC;IACpC,KAAK,GAAG,KAAK,GAAG,YAAU,KAAO,GAAG,EAAE,CAAC;IACvC,KAAK,GAAG,KAAK;qBACP,MAAM,EAAE,OAAO,EAAE,KAAK,EAAE,OAAO,IAAK,KAAK,IAC3C,EAAE,MAAM,EAAE,OAAO,EAAE,KAAK,EAAE,OAAO,EAAE,CAAC;IACxC,GAAG,GAAG,GAAG,GAAG,WAAS,GAAK,GAAG,EAAE,CAAC;IAChC,IAAM,GAAG,GACP,kEAAkE;QAClE,KAAK;QACL,YAAY;QACZ,KAAK;QACL,KAAK;QACL,GAAG,CAAC;IACN,QACEA,2CACE,EAAE,EAAC,mBAAmB,EACtB,KAAK,EAAC,aAAa,EACnB,GAAG,EAAE,GAAG,EACR,WAAW,EAAE,GAAG,EAChB,KAAK,eAAO,KAAK,IACT,EACV;AACJ;;;;"}