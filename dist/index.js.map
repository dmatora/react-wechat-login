{"version":3,"file":"index.js","sources":["../src/react-wechat-login.tsx"],"sourcesContent":["import * as React from \"react\";\r\n\r\nconst WechatLogin = ({\r\n  appid,\r\n  redirectUri,\r\n  state,\r\n  style,\r\n  css,\r\n  onSuccess,\r\n}: {\r\n  appid: string;\r\n  redirectUri: string;\r\n  state?: string;\r\n  style?: {};\r\n  css?: string;\r\n  onSuccess: (v: string) => void;\r\n}) => {\r\n  let sent = false;\r\n  const url = new URL(redirectUri);\r\n  window.addEventListener(\"message\", (event) => {\r\n    if (\r\n      event.origin === url.origin && //确认消息来自于自己的域名 Make sure the message posted from your own origin\r\n      !event.data.source && //过滤掉一些调试组件发来的信息  Filter out some devtools message\r\n      !sent //避免多次运行回调函数  Avoid callback twice\r\n    ) {\r\n      sent = true;\r\n      onSuccess(event.data);\r\n    }\r\n  });\r\n  appid = `appid=${appid}`;\r\n  redirectUri = `&redirect_uri=${encodeURIComponent(redirectUri)}`;\r\n  const scope = `&scope=snsapi_login`;\r\n  state = state ? `&state=${state}` : ``;\r\n  style = style\r\n    ? { height: \"390px\", width: \"300px\", ...style }\r\n    : { height: \"390px\", width: \"300px\" };\r\n  css = css ? `&href=${css}` : ``;\r\n  const src =\r\n    `https://open.weixin.qq.com/connect/qrconnect?self_redirect=true&` +\r\n    appid +\r\n    redirectUri +\r\n    scope +\r\n    state +\r\n    css;\r\n  return (\r\n    <iframe\r\n      // generate a random id for the ifrom in case there are more than one react-wechat-login in one page\r\n      // 随机生成一个iframe的id，以应对同一个页面中有两个登录控件的情况\r\n      id={\"f_wechatlogin_\" + Math.floor(Math.random() * 1000000)}\r\n      title=\"WechatLogin\"\r\n      src={src}\r\n      frameBorder={\"0\"}\r\n      style={{ ...style }}\r\n    ></iframe>\r\n  );\r\n};\r\n\r\nexport default WechatLogin;\r\n"],"names":["React"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAEM,WAAW,GAAG,UAAC,EAcpB;QAbC,KAAK,WAAA,EACL,WAAW,iBAAA,EACX,KAAK,WAAA,EACL,KAAK,WAAA,EACL,GAAG,SAAA,EACH,SAAS,eAAA;IAST,IAAI,IAAI,GAAG,KAAK,CAAC;IACjB,IAAM,GAAG,GAAG,IAAI,GAAG,CAAC,WAAW,CAAC,CAAC;IACjC,MAAM,CAAC,gBAAgB,CAAC,SAAS,EAAE,UAAC,KAAK;QACvC,IACE,KAAK,CAAC,MAAM,KAAK,GAAG,CAAC,MAAM;YAC3B,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM;YAClB,CAAC,IAAI;UACL;YACA,IAAI,GAAG,IAAI,CAAC;YACZ,SAAS,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;SACvB;KACF,CAAC,CAAC;IACH,KAAK,GAAG,WAAS,KAAO,CAAC;IACzB,WAAW,GAAG,mBAAiB,kBAAkB,CAAC,WAAW,CAAG,CAAC;IACjE,IAAM,KAAK,GAAG,qBAAqB,CAAC;IACpC,KAAK,GAAG,KAAK,GAAG,YAAU,KAAO,GAAG,EAAE,CAAC;IACvC,KAAK,GAAG,KAAK;qBACP,MAAM,EAAE,OAAO,EAAE,KAAK,EAAE,OAAO,IAAK,KAAK,IAC3C,EAAE,MAAM,EAAE,OAAO,EAAE,KAAK,EAAE,OAAO,EAAE,CAAC;IACxC,GAAG,GAAG,GAAG,GAAG,WAAS,GAAK,GAAG,EAAE,CAAC;IAChC,IAAM,GAAG,GACP,kEAAkE;QAClE,KAAK;QACL,WAAW;QACX,KAAK;QACL,KAAK;QACL,GAAG,CAAC;IACN,QACEA;;;QAGE,EAAE,EAAE,gBAAgB,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,OAAO,CAAC,EAC1D,KAAK,EAAC,aAAa,EACnB,GAAG,EAAE,GAAG,EACR,WAAW,EAAE,GAAG,EAChB,KAAK,eAAO,KAAK,IACT,EACV;AACJ;;;;"}